function Initialize() { var t = $("#MenuBar").find("ol.breadcrumb"), a = $("<li>", { class: "breadcrumb-item active", text: "Drawings" }); t.append(a) } function LoadShipyardList() { loading.show(), $.getJSON("/DrawingOrders/ShipyardListPage/", function (t) { var a = $("#ShipyardListPage"); $.each(t, function () { var t = this.CompanyIdx, e = this.Name, n = this.SName, d = this.State, s = a.find('input.companyIdx[value="' + t + '"]'); if (0 === s.length) { var i = $("<div>", { class: "col-4 mb-3" }); a.append(i); var r = $("<div>", { class: "card h-100 card_shipyard" }); i.append(r); var o = $("<div>", { class: "card-body" }); r.append(o); var l = $("<button>", { type: "button", class: "btn btn-light", title: "해당 조선소의 전체 Order 목록" }); o.append(l), l.on("click", function () { LoadOrderList($(this).parent().parent(), "All") }); var p = $("<i>", { class: "fas fa-align-justify" }); l.append(p); var c = $("<span>", { class: "badge float-right cursor-pointer badgeNot", "data-count": 0, title: "미완료 Order 목록" }); o.append(c), c.on("click", function () { LoadOrderList($(this).parent().parent(), "NotCompleted") }), s = $("<input>", { type: "hidden", value: t, class: "companyIdx" }), o.append(s); var u = $("<p>", { class: "card-title text-center h5 mt-0", text: n }); o.append(u); var v = $("<p>", { text: e, class: "text-center" }); o.append(v) } if ("70" !== d) { var h = s.siblings(".badgeNot"); h.hasClass("badge-pill") || h.addClass("badge-pill badge-danger"); var f = h.data("count"); h.data("count", f + 1), h.text(h.data("count")) } }), loading.hide() }).fail(function (t) { console.log }) } function LoadOrderList(t, a) { loading.show(); var e = $("#Modal_ServiceList"); e.modal("show"); var n = t.find("p.card-title").text(); e.find(".modal-title").text(n); var d = e.find(".modal-body"); d.empty(); var s = $("<div>", { class: "row mb-2" }); d.append(s); var i = $("<div>", { class: "col text-right" }); s.append(i); var r = $("<button>", { type: "button", class: "btn warning-color cursor-default mr-1", style: "width:0.5rem;" }); i.append(r); var o = $("<span>", { text: "Request", style: "font-size:.8rem;" }); i.append(o), r = $("<button>", { type: "button", class: "btn success-color cursor-default mr-1 ml-2", style: "width:0.5rem;" }), i.append(r), o = $("<span>", { text: "Complete", style: "font-size:.8rem;" }), i.append(o), r = $("<button>", { type: "button", class: "btn danger-color cursor-default mr-1 ml-2", style: "width:0.5rem;" }), i.append(r), o = $("<span>", { text: "Request count", style: "font-size:.8rem;" }), i.append(o); var l = t.find("input.companyIdx").val(); $.getJSON("/DrawingOrders/OrderList", { CompanyIdx: l, method: a }).done(function (t) { $.each(t, function () { var t = this.Id, a = this.HullCode, e = this.AD, n = this.WD, s = this.FD, i = $("<div>", { class: "card p-2 card_hullCode mb-2 cursor-pointer" }); d.append(i), i.on("click", function () { var t = $(this).find("input.vesselIdx").val(); isEmpty(t) || MovePage_Order(t, "VesselIdx") }); var r = $("<div>", { class: "row" }); i.append(r); var o = $("<div>", { class: "col-3" }); r.append(o); var l = $("<input>", { type: "hidden", value: t, class: "vesselIdx" }); o.append(l); var p = $("<span>", { text: a }); o.append(p), o = $("<div>", { class: "col text-right" }), r.append(o); var c = $("<div>", { class: "btn-group mr-2" }); o.append(c); for (var u = 0; u < 3; u++) { var v, h = $("<button>", { type: "button", class: "btn disabled" }); if (c.append(h), 0 === u ? (h.text("AD"), v = e) : 1 === u ? (h.text("WD"), v = n) : 2 === u && (h.text("FD"), v = s), !isEmpty(v)) { h.removeClass("disabled"), h.addClass("cursor-default"), h.val(v.Id); var f = $("<span>", { class: "text-white ml-2", text: "v" + v.Version, style: "font-size:.7rem;" }); h.append(f); var m = v.State; if ("70" === m ? h.addClass("success-color text-white") : "60" === m && h.addClass("warning-color text-white"), 0 !== v.Not) { var b = $("<span>", { class: "badge badge-danger text-white float-right", text: v.Not }); h.append(b) } } } }), loading.hide() }).fail(function (t) { console.log(t) }) } $(window).on("load", function () { Initialize(), LoadShipyardList() });