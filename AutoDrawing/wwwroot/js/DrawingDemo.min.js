var loading = $("#Loading"); function SearchService(e) { $("body").addClass("wait"); var a = $(e).parent().siblings('input[type="text"]').val(), t = new Array, s = $('#SearchBox input[type="checkbox"]:checked'); $.each(s, function () { var e = $(this).parent().parent().siblings().find("select, input"); $.each(e, function () { var e = { name: $(this).prop("name"), value: $(this).val() }; t.push(e) }) }); var n = { Word: a, Options: t }; $.getJSON("/DrawingOrders/SearchService", { json: JSON.stringify(n) }).done(function (e) { var a = $("#SearchResult"); a.empty(); $.each(e, function () { this.YardId; var e = this.Code, t = this.Name, s = this.arrVessel; 1; var n = $("<div>", { class: "card-body special-color text-white rounded cursor-pointer p-1" }); a.append(n), n.on("click", function () { var e = $(this).find(".fas"), a = $(this).siblings(); e.hasClass("fa-caret-down") ? (e.removeClass("fa-caret-down"), e.addClass("fa-caret-up"), a.hide()) : (e.removeClass("fa-caret-up"), e.addClass("fa-caret-down"), a.show()) }); var i = $("<i>", { class: "fas fa-caret-down ml-2 mr-2" }); n.append(i); var r = $("<span>", { text: e, class: "mr-3" }); n.append(r); var o = $("<span>", { text: "(" + t + ")" }); r.after(o); var d = $("<div>"); a.append(d), $.each(s, function () { var e = this.HullCode, a = this.SalesNo, t = this.arrDrawingType, s = $("<div>"); d.append(s); var n = $("<div>", { class: "card-body special-color text-white rounded ml-3 cursor-pointer p-1" }); s.append(n), n.on("click", function () { var e = $(this).find(".fas"), a = $(this).siblings(); e.hasClass("fa-caret-down") ? (e.removeClass("fa-caret-down"), e.addClass("fa-caret-up"), a.hide()) : (e.removeClass("fa-caret-up"), e.addClass("fa-caret-down"), a.show()) }); var i = $("<i>", { class: "fas fa-caret-down ml-2 mr-2" }); n.append(i); var r = $("<span>", { text: e, class: "mr-2" }); n.append(r); var o = $("<span>", { text: "(" + a + ")" }); r.after(o); var c = $("<div>", { class: "ml-3" }); s.append(c), $.each(t, function () { this.ServiceType; var e = this.CodeName, a = this.arrService, t = $("<div>"); c.append(t); var s = $("<div>", { class: "card-body special-color text-white rounded ml-3 cursor-pointer p-1" }); t.append(s), s.on("click", function () { var e = $(this).find(".fas"), a = $(this).siblings(); e.hasClass("fa-caret-down") ? (e.removeClass("fa-caret-down"), e.addClass("fa-caret-up"), a.hide()) : (e.removeClass("fa-caret-up"), e.addClass("fa-caret-down"), a.show()) }); var n = $("<i>", { class: "fas fa-caret-down ml-2 mr-2" }); s.append(n); var i = $("<span>", { text: e }); s.append(i); var r = $("<div>", { class: "ml-3" }); t.append(r), $.each(a, function () { var e = this.Id, a = this.Version, t = this.State, s = this.RequestDate, n = $("<div>", { class: "card-body rounded ml-3 cursor-pointer p-2", text: a }); if (r.append(n), n.on("click", function () { MovePage_Order($(this).find('input[type="hidden"]').val(), "ServiceIdx") }), "70" !== t) { var i = $("<span>", { class: "badge float-right badge-pill badge-danger", text: "Not completed" }); n.append(i) } var o = $("<span>", { class: "ml-5", text: "Request Date : " + s }); n.append(o); var d = $("<input>", { type: "hidden", value: e }); n.append(d) }) }) }) }), $("body").removeClass("wait") }).fail(function (e) { console.log(e) }) } function MovePage_Order(e, a) { loading.show(), $.getJSON("/DrawingOrders/FindOrderId", { id: e, type: a }).done(function (e) { if (0 === e) toastr.error("등록된 Service가 없습니다."); else { var a = "/drawings/orders/" + e + "/Edit/"; location.href = a } }) } $(window).on("load", function () { var e = new Date, a = e.getFullYear() + "-" + (e.getMonth() + 1) + "-" + e.getDate(); $("#StartRequestDate").val(a), $("#FinishRequestDate").val(a), $("#BtnMenu").on("click", function () { $("#Menu").addClass("active"), $(".overlay").fadeIn(), $(this).removeClass("Active").addClass("Inactive") }), $("#dismiss, .overlay").on("click", function () { $("#Menu").removeClass("active"), $(".overlay").fadeOut(), $("#Menu").removeClass("Inactive").addClass("Active") }), $("#Search").on("focus", function () { $("#MenuBar .overlay").fadeIn(), $("#SearchBox").fadeIn() }), $("#Search").on("keydown", function (e) { 13 === e.keyCode && SearchService($(this).parent().find("#SearchButton")) }), $("#SearchButton").on("click", function () { SearchService($(this)) }), $("#MenuBar .overlay").on("click", function () { $(".under").fadeOut(), $(this).fadeOut() }), $(".under .form-check-input").on("change", function () { var e = $(this).siblings("label"), a = $(this).parent().parent().siblings().find("select, input"); $(this).prop("checked") ? (e.removeClass("disabled"), $.each(a, function () { $(this).prop("disabled", !1), $(this).is("select") && SelectLJH($(this)) })) : (e.addClass("disabled"), $.each(a, function () { $(this).prop("disabled", !0), $(this).is("select") && SelectLJH($(this)) })) }) }); var ismousedown, isEmpty = function (e) { return "" === e || null === e || void 0 === e || null !== e && "object" == typeof e && !Object.keys(e).length }; jQuery.fn.draggit = function (e) { var a, t, s, n, i = $(e), r = i.width(), o = i.height(); return i.css("position", "absolute"), this.bind("mousedown", function (i) { var r = $(e).offset(), o = r.left, d = r.top; s = $("body").width(), n = $("body").height(), a = i.pageX - o, t = i.pageY - d, ismousedown = !0 }), $(document).bind("mousemove", function (d) { if (ismousedown) { r = i.width(), o = i.height(); var c = s - r - 10, l = n - o - 10, p = d.pageX, h = d.pageY, u = p - a, v = h - t; u < 0 && (u = 0), v < 0 && (v = 0), u > c && (u = c), v > l && (v = l), $(e).css("top", v + "px"), $(e).css("left", u + "px") } }), $(window).bind("mouseup", function (e) { ismousedown = !1 }), this };