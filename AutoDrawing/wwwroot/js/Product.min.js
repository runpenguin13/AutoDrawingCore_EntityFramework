function initialize() { var t = $("#MenuBar"), e = t.find("ol.breadcrumb"), a = $("<li>", { class: "breadcrumb-item active", text: "Product" }); e.append(a); var n = t.find("div.btn-group"), o = $("<div>", { class: "btn-group mr-3" }); n.before(o); var c = $("<button>", { id: "BtnCreate", type: "button", "data-toggle": "modal", "data-target": "#DivCreate", text: "CREATE", class: "btn success-color text-white" }); o.append(c), c = $("<button>", { id: "BtnCopy", type: "button", "data-toggle": "modal", "data-target": "#DivCopy", text: "COPY", class: "btn warning-color text-white" }), o.append(c), c = $("<button>", { id: "BtnDelete", type: "button", "data-toggle": "modal", "data-target": "#DivDelete", text: "DELETE", class: "btn danger-color text-white" }), o.append(c) } function Search() { loading.show(); var t = $("#Category").val(), e = $("#SearchWord").val(); $.getJSON("/Products/LoadProducts", { search: e, category: t }).done(function (t) { var e = $("#TbList > tbody"); e.empty(), $.each(t, function () { var t = $("<tr>", { "data-id": this.ProductId, "data-type": this.Completion }); e.prepend(t); for (var a = 0; a < 6; a++) { var n = $("<td>"); switch (t.append(n), a) { case 0: var o = $("<input>", { type: "checkbox", value: this.ProductId }); if (n.append(o), "GOODS" === this.Completion) var c = $("<span>", { text: "Model" }); else c = $("<span>", { text: "Component" }); n.append(c); break; case 1: var i = $("<span>", { text: this.EquipmentName }); n.append(i); break; case 2: if (null !== this.Title) { var r = $("<span>", { text: this.Title }); n.append(r) } break; case 3: if (null !== this.ProductModel) { var s = $("<span>", { text: this.ProductModel }); n.append(s) } break; case 4: if (null !== this.Mass) { var d = $("<span>", { text: this.Mass }); n.append(d) } break; case 5: n.addClass("text-right"); var l = $("<button>", { class: "btn btn-light", title: "Copy", value: this.ProductId }); n.append(l); var u = $("<i>", { class: "far fa-copy" }); l.append(u), l.on("click", function () { var t = new Array; t.push($(this).val()), $.ajax({ type: "POST", url: "/Products/CopyProducts", data: { json: JSON.stringify(t) }, success: function () { toastr.success("Success copy"), Search() }, error: function (t) { console.log(t) } }) }) } } }), loading.hide() }) } function CopyProduct() { var t = new Array; $.each($(".table-active input"), function () { var e = $(this).val(); t.push(e) }), $.ajax({ type: "POST", url: "/Products/CopyProducts", data: { json: JSON.stringify(t) }, success: function () { toastr.success("Success copy"), Search() } }) } $(window).on("load", function () { initialize(), Search(), SelectLJH($("select")), $("#SearchWord").keydown(function (t) { 13 === t.keyCode && Search() }), $("#Search").on("click", function () { Search() }), $("#CategoryList button").click(function (t) { var e = $(t.currentTarget); $("#Category").val(e.val()), e.parent().siblings(".dropdown-toggle").find("span").text(e.val()), Search() }), $("#BtnSubmitCreate").click(function () { $.ajax({ type: "POST", url: "/Products/CreateProduct/", data: $("#FormCreate").serialize(), success: function () { $("#DivCreate").modal("toggle"), Search() } }) }), $("#DivEdit").on("show.bs.modal", function () { var t = $("#MainId").val(); $.getJSON("/Products/LoadEditProduct", { proId: t }).done(function (t) { var e = $("#FormEdit input, #FormEdit select"); $.each(e, function () { $(this).val(t[this.name]), $(this).is("select") && SelectLJH($(this)) }) }).fail(function (t, e, a) { var n = e + ", " + a; console.log(n) }) }), $("#BtnSubmitEdit").click(function () { $.ajax({ url: "/Products/SaveEditProduct", data: $("#FormEdit").serialize(), success: function (t) { $("#DivEdit").modal("toggle"), toastr.success("Success save"), Search() } }) }), $("#FormEdit input").keydown(function (t) { 13 === t.keyCode && $("#BtnSubmitEdit").trigger("click") }), $("#BtnSubmitDelete").click(function () { var t = new Array; $.each($("#TbList input:checked"), function () { t.push($(this).val()) }), $.ajax({ type: "POST", url: "/Products/DeleteProduct/", data: { json: JSON.stringify(t) }, success: function (t) { "Success" === t ? ($("#DivDelete").modal("toggle"), Search("", "")) : alert(t) } }) }), $("#BtnSubmitCopy").click(function () { var t = new Array; $.each($("#TbList input:checked"), function () { t.push($(this).val()) }), $.ajax({ type: "POST", url: "/Products/CopyProducts/", data: { json: JSON.stringify(t) }, success: function (t) { $("#DivCopy").modal("toggle"), toastr.success("Success copy", "Success", { positionClass: "toast-bottom-right" }), Search("", "") } }) }), $("#EditEquip").on("change", function () { "7" === $(this).val() ? ($("#EditXComponent").parent().parent().css("display", "none"), $("#EditXComponent").val("")) : $("#EditXComponent").parent().parent().css("display", "flex") }), $("#Equipment").on("change", function () { "7" === $(this).val() ? ($("#XComponent").parent().parent().css("display", "none"), $("#XComponent").val("")) : $("#XComponent").parent().parent().css("display", "flex") }), $("#TbList").delegate("tr", "dblclick", function (t) { var e = $(t.currentTarget).data("type"), a = $(t.currentTarget).data("id"); if ("PARTS" === e) $("#DivEdit #MainId").val(a), $("#DivEdit").modal("toggle"); else { var n = "/Products/" + a + "/Edit/"; location.href = n } }), $("#TbList").delegate("tr", "click", function (t) { if ("checkbox" !== $(t.target).prop("type")) { var e = $(t.currentTarget).find('input[type="checkbox"]'); e.prop("checked", !e.prop("checked")) } $(t.currentTarget).toggleClass("table-active") }), $("#ulCategory button").click(function (t) { var e = $(t.currentTarget); $("#Category").val(e.val()), e.parent().siblings(".dropdown-toggle").find("span").text(e.val()), Search() }) });